#SAS codes for mixed regression (st. pierr method)
#SIMPLE MODEL									
									
Data nayoung;									
INPUT									
study	exp	cpi1	cpi2	cpi3	carcassper	loin	backfat	meatq	marbling
;cards;									
6	6	0.03	0.58	0.77	0.90	0.36	0.69	0.49	0.29
6	6	0.90	0.80	0.77	0.35	0.05	0.90	0.03	0.19
6	6	0.52	0.88	0.72	0.83	0.37	0.87	0.44	0.91
6	6	0.12	0.18	0.90	0.20	0.14	0.96	0.21	0.84
6	6	0.37	0.35	0.44	0.30	0.91	0.76	0.74	0.21
8	8	0.36	0.21	0.38	0.52	0.03	0.53	0.69	0.37
8	8	0.83	0.49	0.01	0.02	0.86	0.20	0.62	0.44
8	8	0.76	0.34	0.20	0.97	0.73	0.60	0.15	0.20
8	8	0.87	0.89	0.29	0.02	0.67	0.47	0.61	0.94
9	9	0.85	0.78	0.54	0.98	0.84	0.76	0.93	0.83
9	9	0.62	0.39	0.81	0.96	0.47	0.54	0.90	0.90
11	11	0.33	0.34	1.00	0.77	0.93	0.81	0.08	0.22
11	11	0.04	0.41	0.19	0.86	0.81	0.97	0.99	0.20
11	11	0.96	0.24	0.35	0.24	0.38	0.03	0.14	0.47
11	11	0.02	0.02	0.24	0.67	0.52	0.72	0.41	0.74
17	17	0.46	0.13	0.03	0.59	0.96	0.34	0.03	0.55
17	17	0.91	0.96	0.70	0.58	0.36	0.34	0.29	0.10
20	20	0.78	0.19	0.94	0.77	0.05	0.10	0.35	0.54
20	20	0.27	0.03	0.76	0.96	0.22	0.14	0.79	0.54
20	20	0.83	0.64	0.22	0.42	0.45	0.90	0.53	0.55
21	21	0.76	0.10	0.25	0.23	0.06	0.69	0.17	0.58
21	21	0.70	0.61	0.08	0.91	0.24	0.34	0.76	0.95
21	21	0.46	0.66	0.37	0.76	0.85	0.64	0.75	0.20
23	23	0.98	0.82	0.92	0.37	0.72	0.43	0.82	0.43
23	23	0.98	0.48	0.19	0.95	0.69	0.87	0.81	0.54
23	23	0.52	0.16	0.01	0.08	0.15	0.33	0.41	0.88
24	24	0.69	0.32	0.63	0.04	0.65	0.06	0.22	0.96
24	24	0.06	0.67	0.61	0.30	0.57	0.33	0.31	0.63
25	25	0.03	0.54	0.29	0.64	0.79	0.92	0.80	0.94
25	25	0.04	0.93	0.89	0.01	0.34	0.34	0.12	0.98
27	27	0.64	0.27	0.80	0.07	0.42	0.30	0.30	0.45
27	27	0.02	0.22	0.66	0.63	0.15	0.50	0.79	0.23
27	27	0.99	0.87	0.47	0.32	0.13	0.49	0.14	0.01
27	27	0.74	0.50	0.56	0.39	0.82	0.34	0.01	0.96
28	28	0.42	0.35	0.00	0.96	0.93	0.86	0.33	1.00
28	28	0.04	0.09	0.51	0.05	0.56	0.76	0.29	0.01
28	28	0.42	0.77	0.40	0.89	0.05	0.03	0.02	0.53
32	32	0.65	0.68	1.00	0.84	0.91	0.11	0.30	0.96
;									
%macro AAA (measurement);									
Title &measurement;									
PROC MIXED DATA=calc6cp COVTEST NOCLPRINT NOITPRINT;									
CLASS study;									
MODEL  &measurement = cpi1/SOLUTION;									
RANDOM intercept cpi1/TYPE=UN SUBJECT= study SOLUTION;									
RUN;									
%mend AAA;									
ods html body='temp.xls';									
					%AAA(carcassper);	%AAA(loin);	%AAA(backfat);	%AAA(meatq);	%AAA(marbling);
Ods html close;									
run;quit;									
									
									
									
#MULTIPLE MODEL									
									
Data nayoung;									
INPUT									
study	exp	cpi1	cpi2	cpi3	carcassper	loin	backfat	meatq	marbling
;cards;									
6	6	0.28	0.92	0.95	0.45	0.04	0.05	0.20	0.40
6	6	0.50	0.11	0.77	0.61	0.29	0.66	0.99	0.23
6	6	0.20	0.63	0.60	0.46	0.60	0.23	0.59	0.82
6	6	0.57	0.41	0.34	0.26	0.66	0.24	0.71	0.89
6	6	0.47	0.19	0.82	0.58	0.12	0.19	0.91	0.94
8	8	0.01	0.27	0.90	0.15	0.27	0.06	0.67	0.57
8	8	0.23	0.17	0.94	0.05	0.16	0.48	0.07	0.66
8	8	0.04	0.03	0.20	0.40	0.70	0.19	0.76	0.53
8	8	0.60	0.27	0.67	0.49	0.35	0.61	0.17	0.77
9	9	0.22	0.95	0.92	0.28	0.80	0.65	0.22	0.62
9	9	0.36	0.08	0.90	0.04	0.02	0.53	0.91	0.80
11	11	0.35	0.32	0.20	0.10	0.35	0.97	0.34	0.80
11	11	0.94	0.31	0.62	0.68	0.24	0.76	0.95	0.54
11	11	0.31	0.51	0.99	0.93	0.33	0.22	0.50	0.11
11	11	0.19	0.50	0.31	0.86	0.94	0.18	0.96	0.55
17	17	0.72	0.23	0.42	0.64	0.20	0.96	0.08	0.10
17	17	0.17	0.25	0.62	0.96	0.12	0.91	0.54	0.29
20	20	0.48	0.62	0.34	0.34	0.70	0.96	0.13	0.98
20	20	0.91	0.98	0.71	0.43	0.12	0.76	0.81	0.97
20	20	0.33	0.77	0.33	0.98	0.28	0.42	0.22	0.79
21	21	0.93	0.65	0.46	0.73	0.72	0.08	0.30	0.57
21	21	0.51	1.00	0.77	0.73	0.72	0.05	0.04	0.88
21	21	0.04	0.90	0.13	0.67	0.08	0.82	0.99	0.47
23	23	0.52	0.09	0.97	0.83	0.43	0.77	0.48	0.16
23	23	0.82	0.74	0.40	0.03	0.20	0.16	0.93	0.01
23	23	0.38	0.27	0.53	0.39	0.94	0.59	0.68	0.00
24	24	0.09	0.15	0.10	0.34	0.93	0.28	0.35	0.35
24	24	0.91	0.39	0.05	0.50	0.45	0.34	0.43	0.84
25	25	0.53	0.50	0.49	0.71	0.92	0.76	0.59	0.96
25	25	0.43	0.17	0.37	0.79	0.23	0.72	0.94	0.94
27	27	0.89	0.34	0.76	0.52	0.51	0.19	0.48	0.91
27	27	0.31	0.84	0.90	0.61	0.42	0.72	0.92	0.93
27	27	0.66	0.52	0.47	0.11	0.82	0.25	0.94	0.84
27	27	0.96	0.51	0.52	0.07	0.47	0.39	0.69	0.70
28	28	0.24	0.38	0.06	0.26	0.50	0.06	0.60	0.06
28	28	0.11	0.76	0.56	0.94	0.90	0.24	0.97	0.19
28	28	0.75	0.12	0.90	0.45	0.86	0.89	0.17	0.75
32	32	0.52	0.86	0.56	0.30	0.83	0.81	0.05	0.79
;									
%macro AAA (measurement);									
Title &measurement;									
PROC MIXED DATA=calc6cp COVTEST NOCLPRINT NOITPRINT;									
CLASS study;									
MODEL  &measurement = cpi1 cpi2/SOLUTION;									
RANDOM intercept cpi1 cpi2/TYPE=VC SUBJECT= study SOLUTION;									
RUN;									
%mend AAA;									
ods html body='temp.xls';									
					%AAA(carcassper);	%AAA(loin);	%AAA(backfat);	%AAA(meatq);	%AAA(marbling);
Ods html close;									
run;quit;									
